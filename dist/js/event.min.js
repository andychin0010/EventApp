var eventApp=angular.module("eventApp",["ngRoute","eventControllers"]);eventApp.config(["$routeProvider",function(e){e.when("/login",{templateUrl:"templates/event-login.html",controller:"eventLoginController"}).when("/events",{templateUrl:"templates/events.html",controller:"eventsController"}).when("/events/create",{templateUrl:"templates/event-create.html",controller:"eventCreateController"}).otherwise({redirectTo:"/login"})}]);var eventControllers=angular.module("eventControllers",["ngSanitize"]);eventControllers.controller("mainController",["$scope",function(e){"undefined"!=typeof Storage&&(e.user=localStorage.getItem("eventApp.user")),e.$on("login",function(t){e.user=localStorage.getItem("eventApp.user")}),e.logout=function(){localStorage.removeItem("eventApp.user"),e.user=null}}]),eventControllers.controller("eventLoginController",["$scope","$window",function(e,t){function n(e){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}function o(e){var t=/^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,16}$/;return t.test(e)}"undefined"!=typeof Storage&&localStorage.getItem("eventApp.user")&&(t.location.href="#/events"),e.submit=function(){var r=e.name,a=e.email,s=e.password,l="";n(a)||(l+="<p>- Email is missing or not valid.</p>"),s?o(s)||(l+="<p>- Password must be as least 6 - 16 characters, contain at least 1 number and 1 special character.</p>"):l+="<p>- Password is missing.</p>",e.errorMessage=l,l||("undefined"!=typeof Storage?(r||(r=a.substring(0,a.lastIndexOf("@"))),localStorage.setItem("eventApp.user",r),t.location.href="#/events",e.$emit("login")):e.errorMessage="Sorry, your browser must support Web Storage.")}}]),eventControllers.controller("eventsController",["$scope","$window",function(e,t){if("undefined"!=typeof Storage){var n=localStorage.getItem("eventApp.user");n?e.name=n:t.location.href="#/login"}var o=localStorage.getItem("eventsObject");if(o)var r=JSON.parse(o);else var r=[];e.events=r,e.createEvent=function(){t.location.href="#/events/create"},e.deleteEvent=function(){var t=localStorage.getItem("eventsObject");if(t){var n=JSON.parse(t);n.pop()}else var n=[event];e.events=n,localStorage.setItem("eventsObject",JSON.stringify(n))}}]),eventControllers.controller("eventCreateController",["$scope","$window",function(e,t){if("undefined"!=typeof Storage){var n=localStorage.getItem("eventApp.user");n?e.eventHost=n:t.location.href="#/login"}e.minDate=new Date,e.submit=function(){var n={};n.eventHost=e.eventHost,n.eventName=e.eventName,n.eventType=e.eventType,n.eventLocation=e.eventLocation,n.eventStartDate=e.eventStartDate,n.eventEndDate=e.eventEndDate,n.eventGuests=e.eventGuests,n.eventNotes=e.eventNotes;var o="",r=new Date;if(n.eventHost?n.eventHost.length>30&&(o+="<p>- Host name is too long, max characters 30.</p>"):o+="<p>- Host is missing.</p>",n.eventName?n.eventHost.length>30&&(o+="<p>- Event name is too long, max characters 30.</p>"):o+="<p>- Event Name is missing.</p>",n.eventType?n.eventHost.length>30&&(o+="<p>- Event Type is too long, max characters 30.</p>"):o+="<p>- Event Type is missing.</p>",n.eventLocation?n.eventHost.length>30&&(o+="<p>- Event Location is too long, max characters 30.</p>"):o+="<p>- Event Location is missing.</p>",n.eventStartDate?n.eventStartDate<r&&(o+="<p>- Event must take place in the future.</p>"):o+="<p>- Event Start Date is missing.</p>",n.eventEndDate?n.eventEndDate<r&&(o+="<p>- Event must end in the future.</p>"):o+="<p>- Event End Date is missing.</p>",n.eventEndDate&&n.eventStartDate&&n.eventStartDate>n.eventEndDate&&(o+="<p>- Event can not take place after it ended.</p>"),n.eventGuests&&n.eventGuests.length>30&&(o+="<p>- Event Guests is too long, max characters 30.</p>"),n.eventNotes&&n.eventNotes.length>30&&(o+="<p>- Event Notes is too long, max characters 30.</p>"),e.errorMessage=o,!o){var a=localStorage.getItem("eventsObject");if(a){var s=JSON.parse(a);s.unshift(n)}else var s=[n];localStorage.setItem("eventsObject",JSON.stringify(s)),t.location.href="#/events"}}}]);